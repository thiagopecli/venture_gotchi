{% extends 'base.html' %}

{% block title %} Ranking - Venture Gotchi {% endblock %}

{% block content %}
<main class="dashboard-main">
    <div class="header-container">
        <h2 class="profile-title"> {{ titulo }}</h2>
        <a href="{% url 'dashboard' %}" class="btn-back-orange">‚Üê Voltar ao Dashboard</a>
    </div>

    <section class="ranking-filter-section">
        <h3>Filtrar por:</h3>
        <div class="filter-group">
            <a href="{% url 'ranking' %}?criterio=valuation" class="filter-btn {% if criterio == 'valuation' %}active{% endif %}">Valuation</a>
            <a href="{% url 'ranking' %}?criterio=saldo" class="filter-btn {% if criterio == 'saldo' %}active{% endif %}">Saldo em Caixa</a>
            <a href="{% url 'ranking' %}?criterio=turno" class="filter-btn {% if criterio == 'turno' %}active{% endif %}">Turno Alcan√ßado</a>
            <a href="{% url 'ranking' %}?criterio=conquistas" class="filter-btn {% if criterio == 'conquistas' %}active{% endif %}">Conquistas</a>
        </div>
    </section>

    {% if startups %}
    <div class="ranking-table-container">
        <table class="modern-table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Empresa</th>
                    <th>Fundador</th>
                    <th class="text-right">Valuation</th>
                    <th class="text-right">Saldo</th>
                    <th class="text-center">Turno</th>
                    <th class="text-center">Funcion√°rios</th>
                    <th class="text-center">Conquistas</th>
                </tr>
            </thead>
            <tbody>
                {% for startup in startups %}
                <tr class="{% if startup.partida.usuario == user %}highlight-row{% endif %}">
                    <td class="rank-number">
                        {% if forloop.counter == 1 %}1¬∫{% elif forloop.counter == 2 %}2¬∫{% elif forloop.counter == 3 %}3¬∫{% else %}{{ forloop.counter }}{% endif %}
                    </td>
                    <td>
                        <span class="company-name">{{ startup.partida.nome_empresa }}</span>
                        {% if startup.partida.usuario == user %}<span class="me-badge">VOC√ä</span>{% endif %}
                    </td>
                    <td>{{ startup.partida.usuario.get_full_name|default:startup.partida.usuario.username }}</td>
                    
                    <td class="text-right color-primary {% if criterio == 'valuation' %}font-bold{% endif %}">
                        R$ {{ startup.valuation|floatformat:2 }}
                    </td>
                    
                    <td class="text-right color-success {% if criterio == 'saldo' %}font-bold{% endif %}">
                        R$ {{ startup.saldo_caixa|floatformat:2 }}
                    </td>
                    
                    <td class="text-center {% if criterio == 'turno' %}font-bold{% endif %}">
                        {{ startup.turno_atual }}
                    </td>
                    
                    <td class="text-center">{{ startup.funcionarios }}</td>
                    
                    <td class="text-center {% if criterio == 'conquistas' %}font-bold{% endif %}">
                        {{ startup.total_conquistas }}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <div class="ranking-footer">
        <p>Exibindo top {{ startups|length }} startups ativas.</p>
        {% if user.is_educador %}
            <span class="educator-note">üí° Modo Educador: Visualiza√ß√£o total habilitada.</span>
        {% endif %}
    </div>

    {% else %}
    <div class="empty-state-container">
        <p class="empty-state">Ainda n√£o h√° startups ativas no ranking.</p>
    </div>
    {% endif %}
</main>
{% endblock %}